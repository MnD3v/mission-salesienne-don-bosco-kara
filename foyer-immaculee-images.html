<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Galerie d'Images – Foyer Immaculée</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #946612; }
    header { background: #fff; padding: 1.5rem 0 0 0; border-bottom: 8px solid #b71c1c; }
    header img { height: 80px; display: block; margin: 0 auto 0.5rem auto; }
    nav {
      background: #003f6b;
      padding: 1rem;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
      position: relative;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1.2rem;
      flex-wrap: wrap;
    }
    nav a, .dropbtn {
      color: #fff;
      font-weight: bold;
      border-radius: 6px;
      padding: 0.5rem 1rem;
      transition: background 0.2s, color 0.2s;
      display: inline-block;
      text-decoration: none;
    }
    nav a:hover, .dropbtn:hover {
      background: #ffd700;
      color: #003f6b;
    }
    .dropdown {
      display: inline-block;
      position: relative;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      background: #005baa;
      min-width: 180px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.10);
      border-radius: 0 0 8px 8px;
      top: 100%;
      left: 0;
      z-index: 100;
    }
    .dropdown-content a {
      color: #fff;
      padding: 1rem 1.2rem;
      text-decoration: none;
      display: block;
      font-weight: normal;
      border-bottom: 1px solid #0072ce;
      transition: background 0.2s;
    }
    .dropdown-content a:last-child {
      border-bottom: none;
    }
    .dropdown-content a:hover {
      background: #0072ce;
      color: #ffd700;
    }
    .dropdown:hover .dropdown-content,
    .dropdown:focus-within .dropdown-content {
      display: block;
    }
    nav > a, nav > .dropdown {
      vertical-align: middle;
    }
    .container { max-width: 1000px; margin: 2rem auto; background: #fff; padding: 2.5rem 2rem; border-radius: 12px; box-shadow: 0 2px 16px rgba(0,0,0,0.08);}
    h2 { color: #005baa; margin-top: 0; }
    .gallery-grid {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 2rem;
      justify-content: center;
      align-items: flex-start;
    }
    .gallery-item {
      background: #f1f6fa;
      border-radius: 10px;
      box-shadow: 0 1px 6px rgba(0,91,170,0.06);
      padding: 1rem;
      width: 260px;
      max-width: 98vw;
      text-align: center;
    }
    .gallery-item img {
      width: 100%;
      max-width: 220px;
      height: 160px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 0.7rem;
    }
    .add-image {
      margin: 2.5rem 0;
      display: none;
      background: #f1f6fa;
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: 0 1px 6px rgba(0,91,170,0.06);
      max-width: 420px;
      margin-left: auto;
      margin-right: auto;
    }
    .add-image input[type="text"] {
      width: 90%;
      padding: 0.6rem;
      margin: 0.5rem 0;
      border-radius: 6px;
      border: 1px solid #bbb;
      font-size: 1rem;
    }
    .add-image button {
      background: #0072ce;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 0.7rem 2rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 0.7rem;
    }
    .add-image button:hover {
      background: #005baa;
    }
    @media (max-width: 900px) {
      .container { padding: 1.2rem; }
      .gallery-grid { gap: 1rem; }
      .gallery-item { width: 98vw; }
    }
  </style>
</head>
<body>
  <header>
    <div style="display: flex; align-items: center; justify-content: center; max-width: 1200px; margin: 15px auto;">
      <img src="logo/logo.png" alt="Logo Mission Salésienne Don Bosco Kara">
    </div>
    <div style="width:100%;overflow:hidden;margin-top:0;">
      <img src="IMAGE/img%20en%20tete.jpg" alt="Bannière Don Bosco Kara" style="width:100%;display:block;object-fit:cover;max-height:220px;">
    </div>
    <nav>
      <a href="index.html">Accueil</a>
      <a href="ong.html">ONG</a>
      <a href="paroisse.html">Paroisse</a>
      <a href="centre-formation.html">Centre de Formation</a>
      <a href="college-lycee.html">Collège & Lycée</a>
      <div class="dropdown">
        <a href="#" class="dropbtn">Foyer ▼</a>
        <div class="dropdown-content">
          <a href="foyer-immaculee.html">Foyer Immaculée</a>
          <a href="foyer-jean-paul-ii.html">Foyer Jean Paul II</a>
        </div>
      </div>
      <a href="oratorio.html">Oratorio</a>
      <a href="pastorale.html">Pastorale</a>
      <a href="actualité.html">Actualités</a>
      <a href="autres.html">Autres</a>
    </nav>
  </header>
  <div class="container">
    <h2>Galerie d'Images</h2>
    <div class="gallery-grid" id="gallery"></div>
    <div id="gallery-table-container" style="margin:2.5rem 0;"></div>
    <div class="add-image">
      <h3>Ajouter une image</h3>
      <input type="text" id="imgUrl" placeholder="Collez ici le lien de l'image (URL)">
      <input type="text" id="imgCaption" placeholder="Légende (facultatif)">
      <br>
      <button onclick="addImage()">Ajouter</button>
    </div>
    <button id="admin-access-btn" style="margin:2rem auto;display:block;background:#0072ce;color:#fff;border:none;border-radius:6px;padding:0.7rem 2rem;font-weight:600;cursor:pointer;">
      Ajouter ou supprimer une image (Accès réservé)
    </button>
  </div>
  <footer>
    <div class="footer-social">
      <a href="https://www.facebook.com/Paroisse.JBK/" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/733/733547.png" alt="Facebook"></a>
      <a href="https://wa.me/70239862" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" alt="WhatsApp"></a>
      <a href="https://www.tiktok.com/@paroisse.saint.je4?_t=ZM-8xU39hlMXK9&_r=1" target="_blank">
        <img src="https://cdn-icons-png.flaticon.com/512/3046/3046121.png" alt="TikTok" width="32" height="32">
      </a>
    </div>
    <div class="footer-contact">
      <strong>Adresse :</strong> Quartier Don Bosco, Kara, Togo<br>
      <strong>Téléphone :</strong> +228 70239862<br>
      <strong>Email :</strong> dt.kara.donbosco.aos@gmail.com
    </div>
    <div style="margin-top:1rem;">
      &copy; 2025 Paroisse Don Bosco Kara. Tous droits réservés.
    </div>
  </footer>
  <script>
    // Images par défaut à afficher lors de la première visite
    const defaultImages = [
      { url: "IMAGE/img/Foyer-Immaculé (1).jpg", caption: "Foyer Immaculée 1" },
      { url: "IMAGE/img/Foyer-Immaculé (2).jpg", caption: "Foyer Immaculée 2" },
      { url: "IMAGE/img/foyer-immaculé.jpg", caption: "Foyer Immaculée 3" },
      { url: "IMAGE/img/Immaculé (2).jpg", caption: "Foyer Immaculée 4" }
    ];

    const AUTHORIZED_PASSWORD = "donbosco2025";
    let isAuthorized = false;

    function saveImagesToStorage(images) {
      localStorage.setItem('foyer_immaculee_gallery_images', JSON.stringify(images));
    }

    function loadImagesFromStorage() {
      const data = localStorage.getItem('foyer_immaculee_gallery_images');
      if (data) {
        try {
          return JSON.parse(data);
        } catch {
          return [];
        }
      }
      saveImagesToStorage(defaultImages);
      return [...defaultImages];
    }

    function renderGallery() {
      const gallery = document.getElementById('gallery');
      gallery.innerHTML = '';
      const images = loadImagesFromStorage();
      images.forEach((img, idx) => {
        const div = document.createElement('div');
        div.className = 'gallery-item';
        div.innerHTML = `
          <img src="${img.url}" alt="${img.caption || 'Image'}" onerror="this.src='https://via.placeholder.com/220x160?text=Image+non+trouv%C3%A9e';">
          <div class="caption">${img.caption || ''}</div>
          ${isAuthorized ? `<button class="delete-btn" onclick="deleteImage(${idx})" style="margin-top:8px;background:#d32f2f;color:#fff;border:none;border-radius:5px;padding:0.4rem 1.2rem;cursor:pointer;">Supprimer</button>` : ''}
        `;
        gallery.appendChild(div);
      });
      renderGalleryTable();
    }

    function renderGalleryTable() {
      const images = loadImagesFromStorage();
      const container = document.getElementById('gallery-table-container');
      if (!isAuthorized || images.length === 0) {
        container.innerHTML = '';
        return;
      }
      let html = `<table style="width:100%;border-collapse:collapse;text-align:left;">
        <thead>
          <tr style="background:#f1f6fa;">
            <th style="padding:8px;border:1px solid #ccc;">Image</th>
            <th style="padding:8px;border:1px solid #ccc;">Légende</th>
            <th style="padding:8px;border:1px solid #ccc;">Action</th>
          </tr>
        </thead>
        <tbody>`;
      images.forEach((img, idx) => {
        html += `<tr>
          <td style="padding:8px;border:1px solid #ccc;"><img src="${img.url}" alt="" style="width:80px;height:60px;object-fit:cover;border-radius:4px;" onerror="this.src='https://via.placeholder.com/80x60?text=Image+non+trouv%C3%A9e';"></td>
          <td style="padding:8px;border:1px solid #ccc;">${img.caption || ''}</td>
          <td style="padding:8px;border:1px solid #ccc;">
            <button onclick="deleteImage(${idx})" style="background:#d32f2f;color:#fff;border:none;border-radius:5px;padding:0.3rem 1rem;cursor:pointer;">Supprimer</button>
          </td>
        </tr>`;
      });
      html += `</tbody></table>`;
      container.innerHTML = html;
    }

    function addImage() {
      if (!isAuthorized) {
        alert("Vous n'êtes pas autorisé à ajouter des images.");
        return;
      }
      const url = document.getElementById('imgUrl').value.trim();
      const caption = document.getElementById('imgCaption').value.trim();
      if (!url) return alert("Veuillez entrer le lien de l'image.");
      // Vérification basique du type d'image
      if (!url.match(/\.(jpeg|jpg|png|gif|webp)$/i)) {
        alert("Veuillez entrer un lien d'image valide (jpg, png, gif, webp).");
        return;
      }
      const images = loadImagesFromStorage();
      images.push({ url, caption });
      saveImagesToStorage(images);
      renderGallery();
      document.getElementById('imgUrl').value = '';
      document.getElementById('imgCaption').value = '';
    }

    function deleteImage(idx) {
      if (!isAuthorized) {
        alert("Vous n'êtes pas autorisé à supprimer des images.");
        return;
      }
      if (!confirm("Voulez-vous vraiment supprimer cette image ?")) return;
      const images = loadImagesFromStorage();
      images.splice(idx, 1);
      saveImagesToStorage(images);
      renderGallery();
    }

    function showAddImageForm() {
      document.querySelector('.add-image').style.display = 'block';
      renderGallery();
    }

    function hideAddImageForm() {
      document.querySelector('.add-image').style.display = 'none';
      renderGallery();
    }

    function askPassword() {
      const pwd = prompt("Veuillez entrer le mot de passe pour ajouter/supprimer des images :");
      if (pwd === AUTHORIZED_PASSWORD) {
        isAuthorized = true;
        showAddImageForm();
        document.getElementById('admin-access-btn').style.display = 'none';
      } else {
        isAuthorized = false;
        hideAddImageForm();
        alert("Accès refusé.");
      }
    }

    window.addEventListener('DOMContentLoaded', function() {
      if (!localStorage.getItem('foyer_immaculee_gallery_images')) {
        saveImagesToStorage(defaultImages);
      }
      renderGallery();
      hideAddImageForm();
      document.getElementById('admin-access-btn').onclick = askPassword;
    });

    // --- Menu déroulant responsive pour "Foyer" ---
    document.querySelectorAll('.dropdown').forEach(function(drop){
      drop.addEventListener('mouseenter', function() {
        this.querySelector('.dropdown-content').style.display = 'block';
      });
      drop.addEventListener('mouseleave', function() {
        this.querySelector('.dropdown-content').style.display = 'none';
      });
      drop.querySelector('.dropbtn').addEventListener('focus', function() {
        drop.querySelector('.dropdown-content').style.display = 'block';
      });
      drop.querySelector('.dropbtn').addEventListener('blur', function() {
        setTimeout(() => drop.querySelector('.dropdown-content').style.display = 'none', 200);
      });
    });

    // --- Scroll doux pour les ancres internes ---
    document.querySelectorAll('a[href^="#"]').forEach(function(link){
      link.addEventListener('click', function(e){
        const target = document.querySelector(this.getAttribute('href'));
        if(target){
          e.preventDefault();
          target.scrollIntoView({behavior: "smooth"});
        }
      });
    });

    // --- Affichage dynamique de l'année dans le footer ---
    document.addEventListener('DOMContentLoaded', function() {
      const year = new Date().getFullYear();
      document.querySelectorAll('footer').forEach(function(footer){
        footer.innerHTML = footer.innerHTML.replace(/202\d/, year);
      });
    });

    // --- Menu mobile (si besoin, à adapter selon ton HTML) ---
    if(window.innerWidth < 900){
      const nav = document.querySelector('nav');
      if(nav && !document.getElementById('menu-toggle')){
        const btn = document.createElement('button');
        btn.id = 'menu-toggle';
        btn.textContent = '☰ Menu';
        btn.style = 'background:#0072ce;color:#fff;border:none;padding:0.7rem 1.5rem;border-radius:6px;font-size:1.2rem;margin-bottom:1rem;cursor:pointer;';
        nav.parentNode.insertBefore(btn, nav);
        nav.style.display = 'none';
        btn.onclick = function(){
          nav.style.display = nav.style.display === 'none' ? 'block' : 'none';
        };
      }
    }
  </script>
  <script src="java.js"></script>
</body>
</html>